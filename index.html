<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - web3_test</title>
	<link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="style2.css">
	<script type="text/javascript" src="js/pageFunction.js"></script>
	<script type="text/javascript" src="js/APIInterface.js"></script>
	<script type="text/javascript" src="js/ContractInteraction.js"></script>
	<!-- <link href="./bootstrap<link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/font-awesome-line-awesome/css/all.min.css">-5.1.3-dist/css/bootstrap.css" rel="stylesheet">
	<link href="./bootstrap-5.1.3-dist/css/bootstrap.min.css" rel="stylesheet"> -->
	<script src='js/node_modules/ethers/dist/ethers.umd.min.js'></script>
	<script src='https://cdn.jsdelivr.net/npm/bignumber.js@9.0.2/bignumber.min.js'></script>
	
	<style>
@media (min-width: 576px) {
  .container-sm, .container {
    max-width: 540px;
  }
}
@media (min-width: 768px) {
  .container-md, .container-sm, .container {
    max-width: 720px;
  }
}
@media (min-width: 992px) {
  .container-lg, .container-md, .container-sm, .container {
    max-width: 960px;
  }
}
@media (min-width: 1200px) {
  .container-xl, .container-lg, .container-md, .container-sm, .container {
    max-width: 1140px;
  }
}
@media (min-width: 1400px) {
  .container-xxl, .container-xl, .container-lg, .container-md, .container-sm, .container {
    max-width: 1320px;
  }
}
	</style>
</head>

<body>
	<div class="main">
		<div class="con">
			<div class="col-12 row justify-content-between">
				<div class=" justify-content-start  col-1">
					<img src="./logoT2.png" alt="Mory Swap" style="max-width: 140px; margin-left: 80px;">
				</div>
				<div style="justify-self:end; " class=" ">
					<br>
					<div class="hrow   center">


						<img src="./metamask.png" alt="MetaMask">

						<button class="btn-signIn center	" id="signInBTN">
							<img src="https://img.icons8.com/nolan/64/login-rounded-right.png"
								style="width: 25px;" />
							<span id="signIn"> sign in</span></button>

						<div class="userBalance" id="userBalance">
							Current Balance:
							<br>
							<span id="balanceAmount">0</span> MRY
						</div>
					</div>
				</div>

			</div>
			<!-- </div> -->
			<div class="  text">

				<h1 class="gradient-text" id="textFit1">Mory Swap</h1>
			</div>
			<div class="descriptionMain" id="descriptionMainText">
				<h2 class="">An outstanding decenteralized finance platform. More About
					<a href="https://www.coindesk.com/learn/what-is-defi/" target="_blank">De Fi here.</a>
				</h2>
				<h2 class="">Steak your liquidity here and take profit. </h2>
				<h2 class="">Register your NFT artworks <a onclick="goToElement('mint-div')">here</a> and put it
					on
					the market. </h2>
				<h2 class="">Check oout Mory Swap white paper <a onclick="goToElement('whitePaper')">here</a>
					and put it on
					the market. </h2>
			</div>









			<br>
			<br>
			<br>
			<br>
			<div class="con">

				<!-- //=============    TRANSFER   ============= -->
				<div class="function-div row justify-content-between" id="testRow">
					<div class="function-text col-sm-12 col-4">
						<h2>Transfer </h2>
						<p> Easy peasy. you can transfer "MRY" here. just enter the destination address and
							amount.</p>

						<div class="warning-box">
							<p><b>WARNING: </b>All of mory swap transactions ar irreversible so be
								carefull
								about addresses and
								actions and...</p>
						</div>




					</div>
					<div class=" function-action col-5 col-sm-12">
						<label for="transfer-destination">Transfer destination address:</label>
						<br>
						<input type="text" class="function-action-input" name="transfer-destination"
							id="transfer-destination" placeholder="0x87B648.....">
						<label for="transfer-destination">Transfer amount:</label>
						<br>
						<input type="number" class="function-action-input" name="transfer-amount"
							id="transfer-amount" placeholder="1000" style="width: 70%;">

						<button onclick="transfer()" id="transferBTN" class="btn-transfer"> Send</button>
					</div>
				</div>


				<!-- //=============    MINE APPLE   ============= -->
				<div class="function-div row justify-content-between">
					<div class=" function-action col-5 col-sm-12">
						<h2>There are only <span>200</span> "APL" avaliable to mine. </h2>

						<label for="transfer-destination">
							<img src="https://s20.picofile.com/file/8445915692/Rolling_1s_31px_3_.gif"
								style="width: 15px;" alt="loading">
							Have 1000 "MRY" in your wallet</label>
						<br>
						<br>
						<label for="transfer-destination">
							<img src="https://s20.picofile.com/file/8445915692/Rolling_1s_31px_3_.gif"
								style="width: 15px;" alt="loading">
							Have enough BNB to pay gas.</label>
						<br>
						<br>


						<button onclick="MineApple()" id="mineApple" class="btn-transfer"
							style="width: 60%;"> Mine
							me an
							"APL" . </button>
					</div>

					<div class="function-text col-sm-12 col-4">
						<h2>What is Apple coin</h2>
						<p> Once you have 1000 "MRY" in your wallet, you can mine an apple coin by just
							burning
							1000 "MRY".</p>
						<p> There is an apple pool on the contract. Every time an NFT is minting, the owner
							of the
							NFT will have to pay 200 "MRY" as the minting fee.</p>
						<p> In order to increase the value of "MRY", 50% of the minting fee will be burned.
							The
							other half will be transfered to the apple pool.</p>


					</div>
				</div>



				<!-- //=============    MINT NFT   ============= -->
				<div class="function-div row justify-content-between" id="mint-div">
					<div class="function-text col-sm-12 col-4">
						<h2>Minting NFT </h2>
						<p> You can mint your own NFT on Mory Swap,
							first you need to have 200 "MRY" in your address. then you need to need to
							enter
							your "tokenURI". the NFT will be minted and registered for your address.</p>
						<p> To learn how to create the tokenUri please read <a
								onclick="goToElement('mint-guid-div')">this part.</a></p>



						<p> In order to increase the value of "MRY", 50% of the minting fee will be burned.
							The
							other half will be transfered to the apple pool.</p>


					</div>
					<div class=" function-action col-5">


						<label for="transfer-destination">NFT tokenUri:</label>
						<br>
						<input type="text" class="function-action-input" id="NFT-mintTokenUri"
							placeholder="https://gateway.pinata.cloud/ipfs/QmcHy2JnPcU7vSYwAhjatDY9W7hkxkeMrqz8N4fapMsB34"
							style="width: 70%;">

						<button onclick="MintNFT()" id="mintNFTBTN" class="btn-transfer"> Mint</button>
						<br>
						<br>
						<div class="warning-box">
							<p><b>WARNING: </b>All of mory swap transactions ar irreversible so be
								carefull
								about addresses and
								actions and...</p>
						</div>
					</div>
				</div>

				<!-- //=============    REQUEST TO BUY NFT   ============= -->
				<div w3-include-html="requestBuyNFT.html"></div>



				<!-- //=============    WHITE PAPER   ============= -->
				<div w3-include-html="whitePaper.html"></div>

			</div>

			<div class="con" id="mint-guid-div">
				<div class="function-div ">

					<div class="function-text">
						<h2>How to create tokenUri: </h2>

						We will use Pinata, a convenient IPFS API and toolkit, to store our NFT asset and
						metadata to ensure our NFT is truly decentralized. If you don’t have a Pinata
						account, sign up for a free account here and complete the steps to verify your
						email.
						<br>
						<br>
						<br>
						Once you’ve created an account:
						<br>
						<br>
						&nbsp &nbsp &nbsp &nbsp &nbsp - Navigate to the “Files” page and click the blue
						"Upload" button at the top-left of
						the page.
						<br>
						<br>

						&nbsp &nbsp &nbsp &nbsp &nbsp - Upload an image to pinata — this will be the image
						asset for your NFT. Feel free to
						name the asset whatever you wish
						<br>
						<br>

						After you upload, you'll see the file info in the table on the Files page. You'll
						also see a CID column. You can copy the CID by clicking the copy button next to it.
						You can view your upload at: https://gateway.pinata.cloud/ipfs/ YOUR CID . You can
						find
						the image we used on IPFS here, for example.
						<br>
						<br>

						For the more visual learners, the steps above are summarized here:
						<br>
						<br>
						<img style="max-width: 100%;"
							src="https://gateway.pinata.cloud/ipfs/Qmcdt5VezYzAJDBc4qN5JbANy5paFg9iKDjq8YksRvZhtL"
							alt=" how to get CID">
						<br>
						<br>
						<br>
						<br>
						<p>Now, we’re going to upload one more document to Pinata. But before we do that, we
							need to create it!</p>
						<p>Download <a download href="./metadata.txt" target="_blank">this document</a> and
							cosumize
							it. Edit name and description to what ever you like. Change the CID in the
							image url to your own CID.
							It should be something like this:
						</p>
						<p>
							&nbsp &nbsp https://gateway.pinata.cloud/ipfs/ + YOUR OWN CID
						</p>
						<p>Make sure image field points to the location of your IPFS image

						</p>
						<p> Once you’re done editing the json file, save it and upload it to Pinata,
							following the same steps we did for uploading the image.</p>
						<p>The document CID add at end of the gateway wuld be your tokenUri. like this
							tokenUri:</p>
						<a href="https://gateway.pinata.cloud/ipfs/QmTuC5njxWhqfJ3SVwCNZX5cSCYh2zaBaE9oHZqigbiiQu"
							target="_blank" style="margin-left: 20px; word-wrap: break-word;">
							https://gateway.pinata.cloud/ipfs/QmTuC5njxWhqfJ3SVwCNZX5cSCYh2zaBaE9oHZqigbiiQu</a>

						<p>When you click on it you can see the content of the document which of course is
							on the IPFS.</p>
						<p>Having this tokenUri you can go back to <a
								onclick="goToElement('mint-div')">Minting NFT section</a> and start to
							mint your NFT</p>
					</div>
				</div>
			</div>
			<div class="con">
				<div class="function-div ">
					<div class="function-text">
						<h2>Recent transactions:</h2>
						<div id="trlist"></div>

					</div>
				</div>
			</div>
		</div>
	</div>



	<script type="text/javascript">
		window.fitText(document.getElementById("textFit1"), 0.7);
		// window.fitText(document.getElementById("descriptionMainText"), 2.4 );

		// setTimeout(() => {
		// 	var allElm = document.getElementsByClassName('row');
		// 	console.log('el cnt: ' + allElm)
		// 	for (let i = 0; i < allElm.length; i++) {
		// 		for (let j = 0; j < allElm.length * 2; j++) {
		// 			try {
		// 				allElm[i].classList.remove('row');
		// 			} catch (error) {

		// 			}
		// 		}
		// 	}
		// }, 1000)

		//window.getElementById('testRow').classList.remove('row')
		// allElm.forEach(element => {
		// 	element.classList.remove('row');
		// });
		console.log("START");
		includeHTML();
		test2()
		trySingIn();
		setBlocks();
		getRecentTransactions();
		//const provider = new ethers.providers.Web3Provider(window.ethereum, "any");

		//getBalance("0x87B64804e36f20acA9052D3b4Cd7188D41b59f97");

		// function httpGet(theUrl) {
		// 	var request = new XMLHttpRequest(); // Create a request variable and assign a new XMLHttpRequest object to it.
		// 	request.open('GET', theUrl); // Open a new connection, using the GET request on the URL endpoint
		// 	request.send();
		// 	var alres;
		// 	request.onload = async function () {
		// 		var data = JSON.parse(this.response);
		// 		//var nt =  data.item[0];

		// 		console.info(data) // depending on your response targert your desired property.
		// 		var count = data.data.pagination.total_count;
		// 		console.log('count: '+count) // depending on your response targert your desired property.
		// 		console.info(data.data.items[count-1].height) // depending on your response targert your desired property.

		// 	}
		// 	//return alres;
		// }
		// httpGet()


		async function getBalance(wallet) {
			await provider.send("eth_requestAccounts", []);
			const signer = provider.getSigner();

			console.log("Account:", await signer.getAddress());
			let balance = await provider.getBalance(wallet);
			// we use the code below to convert the balance from wei to eth
			balance = ethers.utils.formatEther(balance);
			console.log(balance);



			// my contract 
			const myContract = new ethers.Contract(contractAddress, contractABI, signer);

			var bal = myContract.balanceOf(signer.getAddress()).then(function (value) {
				console.log(BigInt(value._hex).toString());
			});

			var Abal = myContract.appleBalanceOf(signer.getAddress()).then(function (value) {
				console.log(BigInt(value._hex).toString());
			});


			//var result = myContract._mineApple();


			var bal = myContract.balanceOf(signer.getAddress()).then(function (value) {
				console.log(BigInt(value._hex).toString());
			});

			var Abal = myContract.appleBalanceOf(signer.getAddress()).then(function (value) {
				console.log(BigInt(value._hex).toString());
			});







		}



	</script>


</body>